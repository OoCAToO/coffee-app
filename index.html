<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Barista Wrist Pro - Large UI</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            background-color: #000; 
            color: #fff; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* 針對圓形與方形手錶優化的容器 */
        .watch-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #000;
            position: relative;
        }

        .scroll-area {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            /* 預設邊距 */
            padding: 40px 10px; 
            text-align: center;
            scrollbar-width: none;
        }
        .scroll-area::-webkit-scrollbar { display: none; }
        
        /* 圓形螢幕自動適應：增加頂部和底部間距以確保內容在圓心 */
        @media (aspect-ratio: 1/1) {
            .scroll-area {
                padding-top: 50px;
                padding-bottom: 50px;
            }
        }

        /* 加大圓形按鈕 */
        .btn-circle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #1a1a1a;
            border: 2px solid #333;
            transition: all 0.1s;
        }
        .btn-circle:active { transform: scale(0.9); background: #333; border-color: #f97316; }
        
        /* 加大功能鍵：改為水平排列（左圖右文） */
        .main-menu-btn {
            background: #111;
            padding: 15px 20px;
            border-radius: 24px;
            margin-bottom: 10px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-start; /* 靠左對齊 */
            gap: 20px; /* 圖文間距 */
            border: 2px solid #222;
        }
        .main-menu-btn:active { border-color: #f97316; background: #222; }

        .list-item {
            background: #111;
            padding: 18px;
            border-radius: 20px;
            margin-bottom: 12px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            font-size: 16px;
            border: 1px solid #222;
        }
        
        .method-btn {
            background: #111;
            padding: 18px 20px;
            border-radius: 22px;
            margin-bottom: 10px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 18px;
            font-weight: bold;
            border: 1px solid #222;
        }

        .toggle-tab {
            background: #1a1a1a;
            padding: 4px;
            border-radius: 25px;
            display: inline-flex;
            margin-bottom: 15px;
            border: 1px solid #333;
            width: 90%;
        }
        .toggle-btn {
            padding: 10px 0;
            flex: 1;
            border-radius: 20px;
            font-size: 15px;
            font-weight: bold;
            color: #888;
        }
        .toggle-btn.active {
            background: #f97316;
            color: #fff;
        }

        .close-btn {
            background: #222;
            color: #ff914d;
            padding: 8px 24px;
            border-radius: 18px;
            font-size: 14px;
            font-weight: 900;
            margin-bottom: 20px;
            display: inline-block;
            border: 1px solid #333;
        }
    </style>
</head>
<body>

    <div id="app">
        <div class="watch-container">
            <!-- 頁面 1: 主選單 (左圖右文，大字體版) -->
            <div id="home-page" class="scroll-area">
                <div class="text-orange-500 text-sm font-black mb-4 tracking-widest uppercase italic">BARISTA PRO</div>
                
                <div class="flex flex-col space-y-3 w-full">
                    <button onclick="router('method')" class="main-menu-btn">
                        <span class="text-4xl">☕</span>
                        <span class="text-xl font-black">選器具</span>
                    </button>
                    <button onclick="router('calc')" class="main-menu-btn">
                        <span class="text-4xl">⚖️</span>
                        <span class="text-xl font-black">計算器</span>
                    </button>
                    <button onclick="router('timer')" class="main-menu-btn">
                        <span class="text-4xl">⏱️</span>
                        <span class="text-xl font-black">計時器</span>
                    </button>
                    <button onclick="router('grind')" class="main-menu-btn">
                        <span class="text-4xl">⚙️</span>
                        <span class="text-xl font-black">研磨度</span>
                    </button>
                </div>
                <div class="h-12"></div>
            </div>

            <!-- 頁面 2: 器具選擇 -->
            <div id="method-page" class="scroll-area hidden">
                <button onclick="router('home')" class="close-btn">返回首頁</button>
                <div id="method-list" class="space-y-2"></div>
                <div class="h-12"></div>
            </div>

            <!-- 頁面 3: 雙向計算器 (特大數字) -->
            <div id="calc-page" class="scroll-area hidden">
                <button onclick="router('home')" class="close-btn">返回</button>
                
                <div class="toggle-tab">
                    <button id="mode-coffee" onclick="setCalcMode('coffee')" class="toggle-btn active">粉量</button>
                    <button id="mode-water" onclick="setCalcMode('water')" class="toggle-btn">水量</button>
                </div>

                <div class="mb-4">
                    <div id="input-label" class="text-sm text-zinc-500 font-bold uppercase">Coffee (g)</div>
                    <div class="flex items-center justify-between px-2 my-2">
                        <button onclick="adjustValue(-1)" class="text-4xl text-orange-500 w-14 h-14 flex items-center justify-center bg-zinc-900 rounded-full active:bg-zinc-800 border-2 border-zinc-700">－</button>
                        <span id="main-val" class="text-6xl font-black tabular-nums">15</span>
                        <button onclick="adjustValue(1)" class="text-4xl text-orange-500 w-14 h-14 flex items-center justify-center bg-zinc-900 rounded-full active:bg-zinc-800 border-2 border-zinc-700">＋</button>
                    </div>
                </div>

                <div class="bg-zinc-900/50 p-5 rounded-[30px] border-2 border-zinc-800">
                    <div id="result-label" class="text-sm text-zinc-500 font-bold">目標水量 (ml)</div>
                    <div id="result-val" class="text-5xl font-black text-blue-500 tabular-nums">225</div>
                    <div id="calc-method-tag" class="text-sm text-zinc-400 mt-2 font-bold italic">V60 (1:15)</div>
                </div>
                <div class="h-12"></div>
            </div>

            <!-- 頁面 4: 計時器 (高對比特大號) -->
            <div id="timer-page" class="scroll-area hidden">
                <button onclick="router('home')" class="close-btn">返回</button>
                <div class="flex justify-between px-2 text-xs font-bold text-zinc-400 mb-2">
                    <span id="timer-target">總水：225</span>
                    <span id="timer-bloom" class="text-orange-400">悶蒸：30</span>
                </div>
                <div id="timer-display" class="text-7xl font-mono font-black mb-2 tracking-tighter tabular-nums text-white">00:00</div>
                <div id="phase-text" class="text-lg font-black text-orange-500 h-8 mb-6 uppercase">READY</div>
                <div class="flex justify-center space-x-6">
                    <button id="timer-btn" onclick="toggleTimer()" class="btn-circle text-green-500 text-4xl">▶</button>
                    <button onclick="resetTimer()" class="btn-circle text-zinc-500 text-4xl">↺</button>
                </div>
                <div class="h-12"></div>
            </div>

            <!-- 頁面 5: 研磨度 -->
            <div id="grind-page" class="scroll-area hidden">
                <button onclick="router('home')" class="close-btn">返回</button>
                
                <div class="toggle-tab mx-auto">
                    <button id="roast-light" onclick="setRoast('light')" class="toggle-btn">淺</button>
                    <button id="roast-medium" onclick="setRoast('medium')" class="toggle-btn active">中</button>
                    <button id="roast-dark" onclick="setRoast('dark')" class="toggle-btn">深</button>
                </div>

                <div id="grind-list" class="space-y-3 px-2 text-left"></div>
                <div class="h-12"></div>
            </div>
        </div>
    </div>

    <script>
        const methods = [
            { id: 'moka', name: '摩卡壺', ratio: 7, baseGrind: '極細', desc: '精鹽' },
            { id: 'v60', name: 'V60 手沖', ratio: 15, baseGrind: '中細', desc: '砂糖' },
            { id: 'syphon', name: '賽風壺', ratio: 12, baseGrind: '中細', desc: '砂糖' },
            { id: 'aeropress', name: '愛樂壓', ratio: 13, baseGrind: '中', desc: '細砂糖' },
            { id: 'french', name: '法壓壺', ratio: 12, baseGrind: '粗', desc: '海鹽' }
        ];

        let currentMethod = methods[1]; 
        let calcMode = 'coffee'; 
        let coffeeWeight = 15;
        let waterWeight = 225;
        let roastLevel = 'medium'; 
        let seconds = 0;
        let timerId = null;

        function init() {
            renderMethods();
            renderGrind();
            renderCalc();
        }

        function router(page) {
            const pages = ['home-page', 'method-page', 'calc-page', 'timer-page', 'grind-page'];
            pages.forEach(p => document.getElementById(p).classList.add('hidden'));
            const target = document.getElementById(page + '-page');
            target.classList.remove('hidden');
            target.scrollTop = 0;
            
            if(page === 'timer') {
                document.getElementById('timer-target').innerText = `總水：${waterWeight}`;
                document.getElementById('timer-bloom').innerText = `悶蒸：${Math.round(coffeeWeight * 2)}`;
            }
            vibrate(10);
        }

        function renderMethods() {
            const list = document.getElementById('method-list');
            list.innerHTML = '';
            methods.forEach(m => {
                const btn = document.createElement('button');
                btn.className = 'method-btn';
                btn.onclick = () => {
                    currentMethod = m;
                    syncValues();
                    renderCalc();
                    router('calc');
                };
                btn.innerHTML = `<span>${m.name}</span><span class="text-sm text-orange-500">1:${m.ratio}</span>`;
                list.appendChild(btn);
            });
        }

        function setCalcMode(mode) {
            calcMode = mode;
            document.getElementById('mode-coffee').classList.toggle('active', mode === 'coffee');
            document.getElementById('mode-water').classList.toggle('active', mode === 'water');
            renderCalc();
            vibrate(15);
        }

        function adjustValue(delta) {
            if (calcMode === 'coffee') {
                coffeeWeight = Math.max(1, coffeeWeight + delta);
                waterWeight = Math.round(coffeeWeight * currentMethod.ratio);
            } else {
                waterWeight = Math.max(10, waterWeight + (delta * 10));
                coffeeWeight = parseFloat((waterWeight / currentMethod.ratio).toFixed(1));
            }
            renderCalc();
            vibrate(5);
        }

        function syncValues() {
            if (calcMode === 'coffee') {
                waterWeight = Math.round(coffeeWeight * currentMethod.ratio);
            } else {
                coffeeWeight = parseFloat((waterWeight / currentMethod.ratio).toFixed(1));
            }
        }

        function renderCalc() {
            document.getElementById('input-label').innerText = calcMode === 'coffee' ? "Coffee (g)" : "Water (ml)";
            document.getElementById('result-label').innerText = calcMode === 'coffee' ? "目標水量 (ml)" : "所需粉量 (g)";
            document.getElementById('main-val').innerText = calcMode === 'coffee' ? coffeeWeight : waterWeight;
            document.getElementById('result-val').innerText = calcMode === 'coffee' ? waterWeight : coffeeWeight;
            document.getElementById('calc-method-tag').innerText = `${currentMethod.name} (1:${currentMethod.ratio})`;
        }

        function setRoast(level) {
            roastLevel = level;
            ['light', 'medium', 'dark'].forEach(l => {
                document.getElementById(`roast-${l}`).classList.toggle('active', roastLevel === l);
            });
            renderGrind();
            vibrate(20);
        }

        function renderGrind() {
            const list = document.getElementById('grind-list');
            list.innerHTML = '';
            methods.forEach(m => {
                const item = document.createElement('div');
                item.className = 'list-item';
                let grindText = m.baseGrind;
                if (roastLevel === 'light' && m.baseGrind === '粗') grindText = '中粗';
                else if (roastLevel === 'dark' && m.baseGrind === '中細') grindText = '中';

                item.innerHTML = `
                    <div class="flex justify-between w-full font-black mb-1">
                        <span class="text-lg">${m.name}</span>
                        <span class="text-orange-500 text-lg">${grindText}</span>
                    </div>
                    <div class="text-sm text-zinc-500 font-bold">對標：${m.desc}</div>
                `;
                list.appendChild(item);
            });
        }

        function toggleTimer() {
            const btn = document.getElementById('timer-btn');
            if (timerId) {
                clearInterval(timerId);
                timerId = null;
                btn.innerHTML = '▶';
                btn.classList.replace('text-red-500', 'text-green-500');
            } else {
                btn.innerHTML = '‖';
                btn.classList.replace('text-green-500', 'text-red-500');
                timerId = setInterval(() => {
                    seconds++;
                    updateTimerDisplay();
                }, 1000);
                vibrate(20);
            }
        }

        function updateTimerDisplay() {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            document.getElementById('timer-display').innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            const phase = document.getElementById('phase-text');
            if (seconds > 0 && seconds <= 30) {
                phase.innerText = `悶蒸: ${Math.round(coffeeWeight * 2)}ml`;
                phase.style.color = "#f97316";
            } else if (seconds > 30) {
                phase.innerText = "穩壓注水中...";
                phase.style.color = "#3b82f6";
            }
            if (seconds === 30 || seconds === 120) vibrate([100, 50, 100]);
        }

        function resetTimer() {
            clearInterval(timerId);
            timerId = null;
            seconds = 0;
            updateTimerDisplay();
            document.getElementById('phase-text').innerText = "READY";
            document.getElementById('phase-text').style.color = "#f97316";
            const btn = document.getElementById('timer-btn');
            btn.innerHTML = '▶';
            btn.classList.replace('text-red-500', 'text-green-500');
        }

        function vibrate(p) { if(window.navigator.vibrate) window.navigator.vibrate(p); }
        init();
    </script>
</body>
</html>
